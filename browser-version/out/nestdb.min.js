!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).NestDB=t()}}(function(){return function t(e,n,r){function i(u,a){if(!n[u]){if(!e[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[u]={exports:{}};e[u][0].call(f.exports,function(t){var n=e[u][1][t];return i(n||t)},f,f.exports,t,e,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,e,n){function r(t,e,n){this.db=t,this.query=e||{},n&&(this.execFn=n)}var i=t("./model"),o=t("underscore");r.prototype.limit=function(t){return this._limit=t,this},r.prototype.skip=function(t){return this._skip=t,this},r.prototype.sort=function(t){return this._sort=t,this},r.prototype.projection=function(t){return this._projection=t,this},r.prototype.project=function(t){var e,n,r,u=[],a=this;return void 0===this._projection||0===Object.keys(this._projection).length?t:(e=0!==this._projection._id,this._projection=o.omit(this._projection,"_id"),(r=Object.keys(this._projection)).forEach(function(t){if(void 0!==n&&a._projection[t]!==n)throw new Error("Can't both keep and omit fields except for _id");n=a._projection[t]}),t.forEach(function(t){var o;1===n?(o={$set:{}},r.forEach(function(e){o.$set[e]=i.getDotValue(t,e),void 0===o.$set[e]&&delete o.$set[e]}),o=i.modify({},o)):(o={$unset:{}},r.forEach(function(t){o.$unset[t]=!0}),o=i.modify(t,o)),e?o._id=t._id:delete o._id,u.push(o)}),u)},r.prototype._exec=function(t){function e(e,n){return c.execFn?c.execFn(e,n,t):t(e,n)}var n,r,o,u=[],a=0,s=0,c=this,f=null;this.db.getCandidates(this.query,function(t,l){if(t)return e(t);try{for(n=0;n<l.length;n+=1)if(i.match(l[n],c.query))if(c._sort)u.push(l[n]);else if(c._skip&&c._skip>s)s+=1;else if(u.push(l[n]),a+=1,c._limit&&c._limit<=a)break}catch(t){return e(t)}if(c._sort){r=Object.keys(c._sort);var h=[];for(n=0;n<r.length;n++)o=r[n],h.push({key:o,direction:c._sort[o]});u.sort(function(t,e){var n,r,o;for(o=0;o<h.length;o++)if(n=h[o],0!==(r=n.direction*i.compareThings(i.getDotValue(t,n.key),i.getDotValue(e,n.key),c.db.compareStrings)))return r;return 0});var p=c._limit||u.length,d=c._skip||0;u=u.slice(d,d+p)}try{u=c.project(u)}catch(t){f=t,u=void 0}return e(f,u)})},r.prototype.exec=function(){this.db.executor.push({this:this,fn:this._exec,arguments:arguments})},e.exports=r},{"./model":6,underscore:15}],2:[function(t,e,n){function r(t){for(var e,n=new Array(t),r=0;r<t;r++)0==(3&r)&&(e=4294967296*Math.random()),n[r]=e>>>((3&r)<<3)&255;return n}function i(t){var e,n,r,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=t.length%3,u="";for(r=0,n=t.length-o;r<n;r+=3)u+=function(t){return i[t>>18&63]+i[t>>12&63]+i[t>>6&63]+i[63&t]}(e=(t[r]<<16)+(t[r+1]<<8)+t[r+2]);switch(o){case 1:e=t[t.length-1],u+=i[e>>2],u+=i[e<<4&63],u+="==";break;case 2:e=(t[t.length-2]<<8)+t[t.length-1],u+=i[e>>10],u+=i[e>>4&63],u+=i[e<<2&63],u+="="}return u}e.exports.uid=function(t){return i(r(Math.ceil(Math.max(8,2*t)))).replace(/[+\/]/g,"").slice(0,t)}},{}],3:[function(t,e,n){function r(t){if(!(this instanceof r))return new r(t);p.call(this);var e=(t=t||{}).filename;this.inMemoryOnly=t.inMemoryOnly||!1,this.autoload=t.autoload||!1,this.timestampData=t.timestampData||!1,e&&"string"==typeof e&&0!==e.length?this.filename=e:(this.filename=null,this.inMemoryOnly=!0),this.compareStrings=t.compareStrings,this.persistence=new l({db:this,afterSerialization:t.afterSerialization,beforeDeserialization:t.beforeDeserialization,corruptAlertThreshold:t.corruptAlertThreshold}),this.executor=new a,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new s({fieldName:"_id",unique:!0}),this.ttlIndexes={},this.autoload&&this.load(t.onload)}var i=t("./customUtils"),o=t("./model"),u=t("async"),a=t("./executor"),s=t("./indexes"),c=t("util"),f=t("underscore"),l=t("./persistence"),h=t("./cursor"),p=t("events");c.inherits(r,p),p.call(r),Object.keys(p.prototype).forEach(function(t){"function"==typeof p.prototype[t]&&(r[t]=p.prototype[t].bind(r))}),r.prototype.load=function(t){var e=this,n=t||function(t){if(t)throw t};this.executor.push({this:this.persistence,fn:this.persistence.loadDatabase,arguments:[function(t){u.setImmediate(function(){t||(e.constructor.listeners("created").length>0&&e.constructor.emit("created",e),e.listeners("loaded").length>0&&e.emit("loaded")),n(t)})}]},!0)},r.prototype.loadDatabase=r.prototype.load,r.prototype.getAllData=function(){return this.indexes._id.getAll()},r.prototype.resetIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].reset(t)})},r.prototype.ensureIndex=function(t,e){var n,r=e||function(){};if(!(t=t||{}).fieldName)return n=new Error("Cannot create an index without a fieldName"),n.missingFieldName=!0,r(n);if(this.indexes[t.fieldName])return r(null);this.indexes[t.fieldName]=new s(t),void 0!==t.expireAfterSeconds&&(this.ttlIndexes[t.fieldName]=t.expireAfterSeconds);try{this.indexes[t.fieldName].insert(this.getAllData())}catch(e){return delete this.indexes[t.fieldName],r(e)}this.persistence.persistNewState([{$$indexCreated:t}],function(t){return r(t?t:null)})},r.prototype.removeIndex=function(t,e){var n=e||function(){};delete this.indexes[t],this.persistence.persistNewState([{$$indexRemoved:t}],function(t){return n(t?t:null)})},r.prototype.addToIndexes=function(t){var e,n,r,i=Object.keys(this.indexes);for(e=0;e<i.length;e+=1)try{this.indexes[i[e]].insert(t)}catch(t){n=e,r=t;break}if(r){for(e=0;e<n;e+=1)this.indexes[i[e]].remove(t);throw r}},r.prototype.removeFromIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].remove(t)})},r.prototype.updateIndexes=function(t,e){var n,r,i,o=Object.keys(this.indexes);for(n=0;n<o.length;n+=1)try{this.indexes[o[n]].update(t,e)}catch(t){r=n,i=t;break}if(i){for(n=0;n<r;n+=1)this.indexes[o[n]].revertUpdate(t,e);throw i}},r.prototype.getCandidates=function(t,e,n){var r,i=Object.keys(this.indexes),o=this;"function"==typeof e&&(n=e,e=!1),u.waterfall([function(e){return r=[],Object.keys(t).forEach(function(e){("string"==typeof t[e]||"number"==typeof t[e]||"boolean"==typeof t[e]||c.isDate(t[e])||null===t[e])&&r.push(e)}),(r=f.intersection(r,i)).length>0?e(null,o.indexes[r[0]].getMatching(t[r[0]])):(r=[],Object.keys(t).forEach(function(e){t[e]&&t[e].hasOwnProperty("$in")&&r.push(e)}),(r=f.intersection(r,i)).length>0?e(null,o.indexes[r[0]].getMatching(t[r[0]].$in)):(r=[],Object.keys(t).forEach(function(e){t[e]&&(t[e].hasOwnProperty("$lt")||t[e].hasOwnProperty("$lte")||t[e].hasOwnProperty("$gt")||t[e].hasOwnProperty("$gte"))&&r.push(e)}),(r=f.intersection(r,i)).length>0?e(null,o.indexes[r[0]].getBetweenBounds(t[r[0]])):e(null,o.getAllData())))},function(t){if(e)return n(null,t);var r=[],i=[],a=Object.keys(o.ttlIndexes);t.forEach(function(t){var e=!0;a.forEach(function(n){void 0!==t[n]&&c.isDate(t[n])&&Date.now()>t[n].getTime()+1e3*o.ttlIndexes[n]&&(e=!1)}),e?i.push(t):r.push(t._id)}),u.eachSeries(r,function(t,e){o._remove({_id:t},{},function(t){return t?n(t):e()})},function(t){return n(null,i)})}])},r.prototype._insert=function(t,e){var n,r=e||function(){};try{n=this.prepareDocumentForInsertion(t),this._insertInCache(n)}catch(t){return r(t)}this.persistence.persistNewState(c.isArray(n)?n:[n],function(t){return t?r(t):r(null,o.deepCopy(n))})},r.prototype.createNewId=function(){var t=i.uid(16);return this.indexes._id.getMatching(t).length>0&&(t=this.createNewId()),t},r.prototype.prepareDocumentForInsertion=function(t){var e,n=this;if(c.isArray(t))e=[],t.forEach(function(t){e.push(n.prepareDocumentForInsertion(t))});else{void 0===(e=o.deepCopy(t))._id&&(e._id=this.createNewId());var r=new Date;this.timestampData&&void 0===e.createdAt&&(e.createdAt=r),this.timestampData&&void 0===e.updatedAt&&(e.updatedAt=r),o.checkObject(e)}return e},r.prototype._insertInCache=function(t){c.isArray(t)?this._insertMultipleDocsInCache(t):this.addToIndexes(t)},r.prototype._insertMultipleDocsInCache=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.addToIndexes(t[e])}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.removeFromIndexes(t[e]);throw r}},r.prototype.insert=function(){this.executor.push({this:this,fn:this._insert,arguments:arguments})},r.prototype.count=function(t,e){var n=new h(this,t,function(t,e,n){return t?n(t):n(null,e.length)});if("function"!=typeof e)return n;n.exec(e)},r.prototype.find=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new h(this,t,function(t,e,n){var r,i=[];if(t)return n(t);for(r=0;r<e.length;r+=1)i.push(o.deepCopy(e[r]));return n(null,i)});if(r.projection(e),"function"!=typeof n)return r;r.exec(n)},r.prototype.findOne=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new h(this,t,function(t,e,n){return t?n(t):1===e.length?n(null,o.deepCopy(e[0])):n(null,null)});if(r.projection(e).limit(1),"function"!=typeof n)return r;r.exec(n)},r.prototype._update=function(t,e,n,r){var i,a,s,c,l=this,p=0;"function"==typeof n&&(r=n,n={}),i=r||function(){},a=void 0!==n.multi&&n.multi,s=void 0!==n.upsert&&n.upsert,u.waterfall([function(n){if(!s)return n();new h(l,t).limit(1)._exec(function(r,u){if(r)return i(r);if(1===u.length)return n();var a;try{o.checkObject(e),a=e}catch(n){try{a=o.modify(o.deepCopy(t,!0),e)}catch(r){return i(r)}}return l._insert(a,function(t,e){return t?i(t):i(null,1,e,!0)})})},function(){var r,u,s=[];l.getCandidates(t,function(h,d){if(h)return i(h);try{for(c=0;c<d.length;c+=1)o.match(d[c],t)&&(a||0===p)&&(p+=1,l.timestampData&&(u=d[c].createdAt),r=o.modify(d[c],e),l.timestampData&&(r.createdAt=u,r.updatedAt=new Date),s.push({oldDoc:d[c],newDoc:r}))}catch(h){return i(h)}try{l.updateIndexes(s)}catch(h){return i(h)}var y=f.pluck(s,"newDoc");l.persistence.persistNewState(y,function(t){if(t)return i(t);if(n.returnUpdatedDocs){var e=[];return y.forEach(function(t){e.push(o.deepCopy(t))}),a||(e=e[0]),i(null,p,e)}return i(null,p)})})}])},r.prototype.update=function(){this.executor.push({this:this,fn:this._update,arguments:arguments})},r.prototype._remove=function(t,e,n){var r,i,u=this,a=0,s=[];"function"==typeof e&&(n=e,e={}),r=n||function(){},i=void 0!==e.multi&&e.multi,this.getCandidates(t,!0,function(e,n){if(e)return r(e);try{n.forEach(function(e){o.match(e,t)&&(i||0===a)&&(a+=1,s.push({$$deleted:!0,_id:e._id}),u.removeFromIndexes(e))})}catch(e){return r(e)}u.persistence.persistNewState(s,function(t){return t?r(t):r(null,a)})})},r.prototype.remove=function(){this.executor.push({this:this,fn:this._remove,arguments:arguments})},r.prototype._destroy=function(t){var e=this,n=t||function(){};e._remove({},{multi:!0},function(t){if(t)return n(t);e.persistence.destroyDatabase(n)})},r.prototype.destroy=function(t){var e=this,n=t||function(){};this.executor.push({this:this,fn:this._destroy,arguments:[function(t){u.setImmediate(function(){t||(e.listeners("destroyed").length>0&&e.emit("destroyed"),e.constructor.listeners("destroyed").length>0&&e.constructor.emit("destroyed",e)),n(t)})}]})},e.exports=r},{"./cursor":1,"./customUtils":2,"./executor":4,"./indexes":5,"./model":6,"./persistence":7,async:9,events:16,underscore:15,util:21}],4:[function(t,e,n){function r(){this.buffer=[],this.ready=!1,this.queue=i.queue(function(t,e){for(var n=[],r=0;r<t.arguments.length;r+=1)n.push(t.arguments[r]);var o=t.arguments[t.arguments.length-1];"function"==typeof o?n[n.length-1]=function(){i.setImmediate(e),o.apply(null,arguments)}:o||0===t.arguments.length?n.push(function(){e()}):n[n.length-1]=function(){e()},t.fn.apply(t.this,n)},1)}var i=t("async");r.prototype.push=function(t,e){this.ready||e?this.queue.push(t):this.buffer.push(t)},r.prototype.processBuffer=function(){var t;for(this.ready=!0,t=0;t<this.buffer.length;t+=1)this.queue.push(this.buffer[t]);this.buffer=[]},e.exports=r},{async:9}],5:[function(t,e,n){function r(t,e){return t===e}function i(t){return null===t?"$null":"string"==typeof t?"$string"+t:"boolean"==typeof t?"$boolean"+t:"number"==typeof t?"$number"+t:c.isArray(t)?"$date"+t.getTime():t}function o(t){this.fieldName=t.fieldName,this.unique=t.unique||!1,this.sparse=t.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:a.compareThings,checkValueEquality:r},this.reset()}var u=t("binary-search-tree").AVLTree,a=t("./model"),s=t("underscore"),c=t("util");o.prototype.reset=function(t){this.tree=new u(this.treeOptions),t&&this.insert(t)},o.prototype.insert=function(t){var e,n,r,o,u;if(c.isArray(t))this.insertMultipleDocs(t);else if(void 0!==(e=a.getDotValue(t,this.fieldName))||!this.sparse)if(c.isArray(e)){for(n=s.uniq(e,i),r=0;r<n.length;r+=1)try{this.tree.insert(n[r],t)}catch(t){u=t,o=r;break}if(u){for(r=0;r<o;r+=1)this.tree.delete(n[r],t);throw u}}else this.tree.insert(e,t)},o.prototype.insertMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.insert(t[e])}catch(t){n=t,r=e;break}if(n){for(e=0;e<r;e+=1)this.remove(t[e]);throw n}},o.prototype.remove=function(t){var e,n=this;c.isArray(t)?t.forEach(function(t){n.remove(t)}):void 0===(e=a.getDotValue(t,this.fieldName))&&this.sparse||(c.isArray(e)?s.uniq(e,i).forEach(function(e){n.tree.delete(e,t)}):this.tree.delete(e,t))},o.prototype.update=function(t,e){if(c.isArray(t))this.updateMultipleDocs(t);else{this.remove(t);try{this.insert(e)}catch(e){throw this.insert(t),e}}},o.prototype.updateMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)this.remove(t[e].oldDoc);for(e=0;e<t.length;e+=1)try{this.insert(t[e].newDoc)}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.remove(t[e].newDoc);for(e=0;e<t.length;e+=1)this.insert(t[e].oldDoc);throw r}},o.prototype.revertUpdate=function(t,e){var n=[];c.isArray(t)?(t.forEach(function(t){n.push({oldDoc:t.newDoc,newDoc:t.oldDoc})}),this.update(n)):this.update(e,t)},o.prototype.getMatching=function(t){var e=this;if(c.isArray(t)){var n={},r=[];return t.forEach(function(t){e.getMatching(t).forEach(function(t){n[t._id]=t})}),Object.keys(n).forEach(function(t){r.push(n[t])}),r}return e.tree.search(t)},o.prototype.getBetweenBounds=function(t){return this.tree.betweenBounds(t)},o.prototype.getAll=function(){var t=[];return this.tree.executeOnEveryNode(function(e){var n;for(n=0;n<e.data.length;n+=1)t.push(e.data[n])}),t},e.exports=o},{"./model":6,"binary-search-tree":10,underscore:15,util:21}],6:[function(t,e,n){function r(t,e){if("number"==typeof t&&(t=t.toString()),!("$"!==t[0]||"$$date"===t&&"number"==typeof e||"$$deleted"===t&&!0===e||"$$indexCreated"===t||"$$indexRemoved"===t))throw new Error("Field names cannot begin with the $ character");if(-1!==t.indexOf("."))throw new Error("Field names cannot contain a .")}function i(t){v.isArray(t)&&t.forEach(function(t){i(t)}),"object"==typeof t&&null!==t&&Object.keys(t).forEach(function(e){r(e,t[e]),i(t[e])})}function o(t,e){var n;return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||v.isDate(t)?t:v.isArray(t)?(n=[],t.forEach(function(t){n.push(o(t,e))}),n):"object"==typeof t?(n={},Object.keys(t).forEach(function(r){(!e||"$"!==r[0]&&-1===r.indexOf("."))&&(n[r]=o(t[r],e))}),n):void 0}function u(t){return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||v.isDate(t)||v.isArray(t)}function a(t,e){return t<e?-1:t>e?1:0}function s(t,e){var n,r;for(n=0;n<Math.min(t.length,e.length);n+=1)if(0!==(r=c(t[n],e[n])))return r;return a(t.length,e.length)}function c(t,e,n){var r,i,o,u,f=n||a;if(void 0===t)return void 0===e?0:-1;if(void 0===e)return void 0===t?0:1;if(null===t)return null===e?0:-1;if(null===e)return null===t?0:1;if("number"==typeof t)return"number"==typeof e?a(t,e):-1;if("number"==typeof e)return"number"==typeof t?a(t,e):1;if("string"==typeof t)return"string"==typeof e?f(t,e):-1;if("string"==typeof e)return"string"==typeof t?f(t,e):1;if("boolean"==typeof t)return"boolean"==typeof e?a(t,e):-1;if("boolean"==typeof e)return"boolean"==typeof t?a(t,e):1;if(v.isDate(t))return v.isDate(e)?a(t.getTime(),e.getTime()):-1;if(v.isDate(e))return v.isDate(t)?a(t.getTime(),e.getTime()):1;if(v.isArray(t))return v.isArray(e)?s(t,e):-1;if(v.isArray(e))return v.isArray(t)?s(t,e):1;for(r=Object.keys(t).sort(),i=Object.keys(e).sort(),u=0;u<Math.min(r.length,i.length);u+=1)if(0!==(o=c(t[r[u]],e[i[u]])))return o;return a(r.length,i.length)}function f(t){return function(e,n,r){var i="string"==typeof n?n.split("."):n;if(1===i.length)b[t](e,n,r);else{if(void 0===e[i[0]]){if("$unset"===t)return;e[i[0]]={}}m[t](e[i[0]],i.slice(1),r)}}}function l(t,e){var n,r,i="string"==typeof e?e.split("."):e;if(t){if(0===i.length)return t;if(1===i.length)return t[i[0]];if(v.isArray(t[i[0]])){if("number"==typeof(n=parseInt(i[1],10))&&!isNaN(n))return l(t[i[0]][n],i.slice(2));for(r=new Array,n=0;n<t[i[0]].length;n+=1)r.push(l(t[i[0]][n],i.slice(1)));return r}return l(t[i[0]],i.slice(1))}}function h(t,e){var n,r,i;if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return t===e;if(v.isDate(t)||v.isDate(e))return v.isDate(t)&&v.isDate(e)&&t.getTime()===e.getTime();if((!v.isArray(t)||!v.isArray(e))&&(v.isArray(t)||v.isArray(e))||void 0===t||void 0===e)return!1;try{n=Object.keys(t),r=Object.keys(e)}catch(t){return!1}if(n.length!==r.length)return!1;for(i=0;i<n.length;i+=1){if(-1===r.indexOf(n[i]))return!1;if(!h(t[n[i]],e[n[i]]))return!1}return!0}function p(t,e){return!("string"!=typeof t&&"number"!=typeof t&&!v.isDate(t)&&"string"!=typeof e&&"number"!=typeof e&&!v.isDate(e))&&typeof t==typeof e}function d(t,e){var n,r,i,o;if(u(t)||u(e))return y({needAKey:t},"needAKey",e);for(n=Object.keys(e),o=0;o<n.length;o+=1)if(r=n[o],i=e[r],"$"===r[0]){if(!k[r])throw new Error("Unknown logical operator "+r);if(!k[r](t,i))return!1}else if(!y(t,r,i))return!1;return!0}function y(t,e,n,r){var i,o,u,a,s=l(t,e);if(v.isArray(s)&&!r){if(v.isArray(n))return y(t,e,n,!0);if(null!==n&&"object"==typeof n&&!v.isRegExp(n))for(o=Object.keys(n),i=0;i<o.length;i+=1)if(x[o[i]])return y(t,e,n,!0);for(i=0;i<s.length;i+=1)if(y({k:s[i]},"k",n))return!0;return!1}if(null!==n&&"object"==typeof n&&!v.isRegExp(n)&&!v.isArray(n)){if(o=Object.keys(n),u=g.map(o,function(t){return t[0]}),0!==(a=g.filter(u,function(t){return"$"===t})).length&&a.length!==u.length)throw new Error("You cannot mix operators and normal fields");if(a.length>0){for(i=0;i<o.length;i+=1){if(!w[o[i]])throw new Error("Unknown comparison function "+o[i]);if(!w[o[i]](s,n[o[i]]))return!1}return!0}}return v.isRegExp(n)?w.$regex(s,n):!!h(s,n)}var v=t("util"),g=t("underscore"),m={},b={},w={},k={},x={};b.$set=function(t,e,n){t[e]=n},b.$unset=function(t,e,n){delete t[e]},b.$push=function(t,e,n){if(t.hasOwnProperty(e)||(t[e]=[]),!v.isArray(t[e]))throw new Error("Can't $push an element on non-array values");if(null!==n&&"object"==typeof n&&n.$slice&&void 0===n.$each&&(n.$each=[]),null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>=3||2===Object.keys(n).length&&void 0===n.$slice)throw new Error("Can only use $slice in cunjunction with $each when $push to array");if(!v.isArray(n.$each))throw new Error("$each requires an array value");if(n.$each.forEach(function(n){t[e].push(n)}),void 0===n.$slice||"number"!=typeof n.$slice)return;if(0===n.$slice)t[e]=[];else{var r,i,o=t[e].length;n.$slice<0?(r=Math.max(0,o+n.$slice),i=o):n.$slice>0&&(r=0,i=Math.min(o,n.$slice)),t[e]=t[e].slice(r,i)}}else t[e].push(n)},b.$addToSet=function(t,e,n){var r=!0;if(t.hasOwnProperty(e)||(t[e]=[]),!v.isArray(t[e]))throw new Error("Can't $addToSet an element on non-array values");if(null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>1)throw new Error("Can't use another field in conjunction with $each");if(!v.isArray(n.$each))throw new Error("$each requires an array value");n.$each.forEach(function(n){b.$addToSet(t,e,n)})}else t[e].forEach(function(t){0===c(t,n)&&(r=!1)}),r&&t[e].push(n)},b.$pop=function(t,e,n){if(!v.isArray(t[e]))throw new Error("Can't $pop an element from non-array values");if("number"!=typeof n)throw new Error(n+" isn't an integer, can't use it with $pop");0!==n&&(t[e]=n>0?t[e].slice(0,t[e].length-1):t[e].slice(1))},b.$pull=function(t,e,n){var r,i;if(!v.isArray(t[e]))throw new Error("Can't $pull an element from non-array values");for(i=(r=t[e]).length-1;i>=0;i-=1)d(r[i],n)&&r.splice(i,1)},b.$inc=function(t,e,n){if("number"!=typeof n)throw new Error(n+" must be a number");if("number"!=typeof t[e]){if(g.has(t,e))throw new Error("Don't use the $inc modifier on non-number fields");t[e]=n}else t[e]+=n},b.$max=function(t,e,n){void 0===t[e]?t[e]=n:n>t[e]&&(t[e]=n)},b.$min=function(t,e,n){void 0===t[e]?t[e]=n:n<t[e]&&(t[e]=n)},Object.keys(b).forEach(function(t){m[t]=f(t)}),w.$lt=function(t,e){return p(t,e)&&t<e},w.$lte=function(t,e){return p(t,e)&&t<=e},w.$gt=function(t,e){return p(t,e)&&t>e},w.$gte=function(t,e){return p(t,e)&&t>=e},w.$ne=function(t,e){return void 0===t||!h(t,e)},w.$in=function(t,e){var n;if(!v.isArray(e))throw new Error("$in operator called with a non-array");for(n=0;n<e.length;n+=1)if(h(t,e[n]))return!0;return!1},w.$nin=function(t,e){if(!v.isArray(e))throw new Error("$nin operator called with a non-array");return!w.$in(t,e)},w.$regex=function(t,e){if(!v.isRegExp(e))throw new Error("$regex operator called with non regular expression");return"string"==typeof t&&e.test(t)},w.$exists=function(t,e){return e=!(!e&&""!==e),void 0===t?!e:e},w.$size=function(t,e){if(!v.isArray(t))return!1;if(e%1!=0)throw new Error("$size operator called without an integer");return t.length==e},w.$elemMatch=function(t,e){if(!v.isArray(t))return!1;for(var n=t.length,r=!1;n--;)if(d(t[n],e)){r=!0;break}return r},x.$size=!0,x.$elemMatch=!0,k.$or=function(t,e){var n;if(!v.isArray(e))throw new Error("$or operator used without an array");for(n=0;n<e.length;n+=1)if(d(t,e[n]))return!0;return!1},k.$and=function(t,e){var n;if(!v.isArray(e))throw new Error("$and operator used without an array");for(n=0;n<e.length;n+=1)if(!d(t,e[n]))return!1;return!0},k.$not=function(t,e){return!d(t,e)},k.$where=function(t,e){var n;if(!g.isFunction(e))throw new Error("$where operator used without a function");if(n=e.call(t),!g.isBoolean(n))throw new Error("$where function must return boolean");return n},e.exports.serialize=function(t){return JSON.stringify(t,function(t,e){if(r(t,e),void 0!==e)return null===e?null:"function"==typeof this[t].getTime?{$$date:this[t].getTime()}:e})},e.exports.deserialize=function(t){return JSON.parse(t,function(t,e){return"$$date"===t?new Date(e):"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?e:e&&e.$$date?e.$$date:e})},e.exports.deepCopy=o,e.exports.checkObject=i,e.exports.isPrimitiveType=u,e.exports.modify=function(t,e){var n,r,u=Object.keys(e),a=g.map(u,function(t){return t[0]}),s=g.filter(a,function(t){return"$"===t});if(-1!==u.indexOf("_id")&&e._id!==t._id)throw new Error("You cannot change a document's _id");if(0!==s.length&&s.length!==a.length)throw new Error("You cannot mix modifiers and normal fields");if(0===s.length?(n=o(e))._id=t._id:(r=g.uniq(u),n=o(t),r.forEach(function(t){if(!m[t])throw new Error("Unknown modifier "+t);if("object"!=typeof e[t])throw new Error("Modifier "+t+"'s argument must be an object");Object.keys(e[t]).forEach(function(r){m[t](n,r,e[t][r])})})),i(n),t._id!==n._id)throw new Error("You can't change a document's _id");return n},e.exports.getDotValue=l,e.exports.match=d,e.exports.areThingsEqual=h,e.exports.compareThings=c},{underscore:15,util:21}],7:[function(t,e,n){function r(t){var e,n,r;if(this.db=t.db,this.inMemoryOnly=this.db.inMemoryOnly,this.filename=this.db.filename,this.corruptAlertThreshold=void 0!==t.corruptAlertThreshold?t.corruptAlertThreshold:.1,!this.inMemoryOnly&&this.filename&&"~"===this.filename.charAt(this.filename.length-1))throw new Error("The datafile name can't end with a ~, which is reserved for crash safe backup files");if(t.afterSerialization&&!t.beforeDeserialization)throw new Error("Serialization hook defined but deserialization hook undefined, cautiously refusing to start NestDB to prevent dataloss");if(!t.afterSerialization&&t.beforeDeserialization)throw new Error("Serialization hook undefined but deserialization hook defined, cautiously refusing to start NestDB to prevent dataloss");for(this.afterSerialization=t.afterSerialization||function(t){return t},this.beforeDeserialization=t.beforeDeserialization||function(t){return t},e=1;e<30;e+=1)for(n=0;n<10;n+=1)if(r=s.uid(e),this.beforeDeserialization(this.afterSerialization(r))!==r)throw new Error("beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NestDB to prevent dataloss")}var i=t("./storage"),o=t("path"),u=t("./model"),a=t("async"),s=t("./customUtils"),c=t("./indexes");r.ensureDirectoryExists=function(t,e){var n=e||function(){};i.mkdirp(t,function(t){return n(t)})},r.prototype.persistCachedDatabase=function(t){var e=t||function(){},n="",r=this;if(this.inMemoryOnly)return e(null);this.db.getAllData().forEach(function(t){n+=r.afterSerialization(u.serialize(t))+"\n"}),Object.keys(this.db.indexes).forEach(function(t){"_id"!=t&&(n+=r.afterSerialization(u.serialize({$$indexCreated:{fieldName:t,unique:r.db.indexes[t].unique,sparse:r.db.indexes[t].sparse}}))+"\n")}),i.crashSafeWriteFile(this.filename,n,function(t){return t?e(t):(r.db.emit("compacted"),e(null))})},r.prototype.compactDatafile=function(){this.db.executor.push({this:this,fn:this.persistCachedDatabase,arguments:arguments})},r.prototype.setAutocompactionInterval=function(t){var e=this,n=Math.max(t||0,5e3);this.stopAutocompaction(),this.autocompactionIntervalId=setInterval(function(){e.compactDatafile()},n)},r.prototype.stopAutocompaction=function(){this.autocompactionIntervalId&&clearInterval(this.autocompactionIntervalId)},r.prototype.persistNewState=function(t,e){var n=this,r="",o=e||function(){};return n.inMemoryOnly?o(null):(t.forEach(function(t){r+=n.afterSerialization(u.serialize(t))+"\n"}),0===r.length?o(null):void i.appendFile(n.filename,r,"utf8",function(t){return o(t)}))},r.prototype.treatRawData=function(t){var e,n=t.split("\n"),r={},i=[],o={},a=-1;for(e=0;e<n.length;e+=1){var s;try{(s=u.deserialize(this.beforeDeserialization(n[e])))._id?!0===s.$$deleted?delete r[s._id]:r[s._id]=s:s.$$indexCreated&&void 0!=s.$$indexCreated.fieldName?o[s.$$indexCreated.fieldName]=s.$$indexCreated:"string"==typeof s.$$indexRemoved&&delete o[s.$$indexRemoved]}catch(t){a+=1}}if(n.length>0&&a/n.length>this.corruptAlertThreshold)throw new Error("More than "+Math.floor(100*this.corruptAlertThreshold)+"% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NestDB to prevent dataloss");return Object.keys(r).forEach(function(t){i.push(r[t])}),{data:i,indexes:o}},r.prototype.loadDatabase=function(t){var e=t||function(){},n=this;if(n.db.resetIndexes(),n.inMemoryOnly)return e(null);a.waterfall([function(t){r.ensureDirectoryExists(o.dirname(n.filename),function(e){i.ensureDatafileIntegrity(n.filename,function(e){i.readFile(n.filename,"utf8",function(e,r){if(e)return t(e);try{var i=n.treatRawData(r)}catch(e){return t(e)}Object.keys(i.indexes).forEach(function(t){n.db.indexes[t]=new c(i.indexes[t])});try{n.db.resetIndexes(i.data)}catch(e){return n.db.resetIndexes(),t(e)}n.db.persistence.persistCachedDatabase(t)})})})}],function(t){return t?e(t):(n.db.executor.processBuffer(),e(null))})},r.prototype.destroyDatabase=function(t){var e=t||function(){},n=this;if(n.db.resetIndexes(),n.inMemoryOnly)return e(null);i.ensureFileDoesntExist(n.filename,e)},e.exports=r},{"./customUtils":2,"./indexes":5,"./model":6,"./storage":8,async:9,path:17}],8:[function(t,e,n){function r(t,e,n,r){"function"==typeof n&&(r=n),i.setItem(t,e,function(){return r()})}var i=t("localforage");i.config({name:"NestDB",storeName:"nestdbdata"}),e.exports.exists=function(t,e){i.getItem(t,function(t,n){return e(null!==n)})},e.exports.rename=function(t,e,n){i.getItem(t,function(r,o){null===o?i.removeItem(e,function(){return n()}):i.setItem(e,o,function(){i.removeItem(t,function(){return n()})})})},e.exports.writeFile=r,e.exports.crashSafeWriteFile=r,e.exports.appendFile=function(t,e,n,r){"function"==typeof n&&(r=n),i.getItem(t,function(n,o){o=o||"",o+=e,i.setItem(t,o,function(){return r()})})},e.exports.readFile=function(t,e,n){"function"==typeof e&&(n=e),i.getItem(t,function(t,e){return n(null,e||"")})},e.exports.unlink=function(t,e){i.removeItem(t,function(){return e()})},e.exports.mkdirp=function(t,e){return e()},e.exports.ensureDatafileIntegrity=function(t,e){return e(null)}},{localforage:14}],9:[function(t,e,n){(function(t,n){!function(){function r(){}function i(t){return t}function o(t){return!!t}function u(t){return!t}function a(t){return function(){if(null===t)throw new Error("Callback was already called.");t.apply(this,arguments),t=null}}function s(t){return function(){null!==t&&(t.apply(this,arguments),t=null)}}function c(t){return z(t)||"number"==typeof t.length&&t.length>=0&&t.length%1==0}function f(t,e){for(var n=-1,r=t.length;++n<r;)e(t[n],n,t)}function l(t,e){for(var n=-1,r=t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function h(t){return l(Array(t),function(t,e){return e})}function p(t,e,n){return f(t,function(t,r,i){n=e(n,t,r,i)}),n}function d(t,e){f(P(t),function(n){e(t[n],n)})}function y(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function v(t){var e,n,r=-1;return c(t)?(e=t.length,function(){return++r<e?r:null}):(n=P(t),e=n.length,function(){return++r<e?n[r]:null})}function g(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r)}}}function m(t){return function(e,n,r){return t(e,r)}}function b(t){return function(e,n,i){i=s(i||r);var o=v(e=e||[]);if(t<=0)return i(null);var u=!1,c=0,f=!1;!function r(){if(u&&c<=0)return i(null);for(;c<t&&!f;){var s=o();if(null===s)return u=!0,void(c<=0&&i(null));c+=1,n(e[s],s,a(function(t){c-=1,t?(i(t),f=!0):r()}))}}()}}function w(t){return function(e,n,r){return t(L.eachOf,e,n,r)}}function k(t){return function(e,n,r,i){return t(b(n),e,r,i)}}function x(t){return function(e,n,r){return t(L.eachOfSeries,e,n,r)}}function _(t,e,n,i){i=s(i||r);var o=c(e=e||[])?[]:{};t(e,function(t,e,r){n(t,function(t,n){o[e]=n,r(t)})},function(t){i(t,o)})}function E(t,e,n,r){var i=[];t(e,function(t,e,r){n(t,function(n){n&&i.push({index:e,value:t}),r()})},function(){r(l(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})}function O(t,e,n,r){E(t,e,function(t,e){n(t,function(t){e(!t)})},r)}function S(t,e,n){return function(r,i,o,u){function a(){u&&u(n(!1,void 0))}function s(t,r,i){if(!u)return i();o(t,function(r){u&&e(r)&&(u(n(!0,t)),u=o=!1),i()})}arguments.length>3?t(r,i,s,a):(u=o,o=i,t(r,s,a))}}function A(t,e){return e}function j(t,e,n){n=n||r;var i=c(e)?[]:{};t(e,function(t,e,n){t(g(function(t,r){r.length<=1&&(r=r[0]),i[e]=r,n(t)}))},function(t){n(t,i)})}function I(t,e,n,r){var i=[];t(e,function(t,e,r){n(t,function(t,e){i=i.concat(e||[]),r(t)})},function(t){r(t,i)})}function D(t,e,n){function i(t,e,n,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(t.started=!0,z(e)||(e=[e]),0===e.length&&t.idle())return L.setImmediate(function(){t.drain()});f(e,function(e){var o={data:e,callback:i||r};n?t.tasks.unshift(o):t.tasks.push(o),t.tasks.length===t.concurrency&&t.saturated()}),L.setImmediate(t.process)}function o(t,e){return function(){u-=1;var n=!1,r=arguments;f(e,function(t){f(s,function(e,r){e!==t||n||(s.splice(r,1),n=!0)}),t.callback.apply(t,r)}),t.tasks.length+u===0&&t.drain(),t.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var u=0,s=[],c={tasks:[],concurrency:e,payload:n,saturated:r,empty:r,drain:r,started:!1,paused:!1,push:function(t,e){i(c,t,!1,e)},kill:function(){c.drain=r,c.tasks=[]},unshift:function(t,e){i(c,t,!0,e)},process:function(){for(;!c.paused&&u<c.concurrency&&c.tasks.length;){var e=c.payload?c.tasks.splice(0,c.payload):c.tasks.splice(0,c.tasks.length),n=l(e,function(t){return t.data});0===c.tasks.length&&c.empty(),u+=1,s.push(e[0]);var r=a(o(c,e));t(n,r)}},length:function(){return c.tasks.length},running:function(){return u},workersList:function(){return s},idle:function(){return c.tasks.length+u===0},pause:function(){c.paused=!0},resume:function(){if(!1!==c.paused){c.paused=!1;for(var t=Math.min(c.concurrency,c.tasks.length),e=1;e<=t;e++)L.setImmediate(c.process)}}};return c}function $(t){return g(function(e,n){e.apply(null,n.concat([g(function(e,n){"object"==typeof console&&(e?console.error&&console.error(e):console[t]&&f(n,function(e){console[t](e)}))})]))})}function N(t){return function(e,n,r){t(h(e),n,r)}}function T(t){return g(function(e,n){var r=g(function(n){var r=this,i=n.pop();return t(e,function(t,e,i){t.apply(r,n.concat([i]))},i)});return n.length?r.apply(this,n):r})}function C(t){return g(function(e){var n=e.pop();e.push(function(){var t=arguments;r?L.setImmediate(function(){n.apply(null,t)}):n.apply(null,t)});var r=!0;t.apply(this,e),r=!1})}var M,L={},B="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n||this;null!=B&&(M=B.async),L.noConflict=function(){return B.async=M,L};var R=Object.prototype.toString,z=Array.isArray||function(t){return"[object Array]"===R.call(t)},F=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},P=Object.keys||function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e},q="function"==typeof setImmediate&&setImmediate,K=q?function(t){q(t)}:function(t){setTimeout(t,0)};"object"==typeof t&&"function"==typeof t.nextTick?L.nextTick=t.nextTick:L.nextTick=K,L.setImmediate=q?K:L.nextTick,L.forEach=L.each=function(t,e,n){return L.eachOf(t,m(e),n)},L.forEachSeries=L.eachSeries=function(t,e,n){return L.eachOfSeries(t,m(e),n)},L.forEachLimit=L.eachLimit=function(t,e,n,r){return b(e)(t,m(n),r)},L.forEachOf=L.eachOf=function(t,e,n){n=s(n||r);for(var i,o=v(t=t||[]),u=0;null!=(i=o());)u+=1,e(t[i],i,a(function(t){u--,t?n(t):null===i&&u<=0&&n(null)}));0===u&&n(null)},L.forEachOfSeries=L.eachOfSeries=function(t,e,n){function i(){var r=!0;if(null===u)return n(null);e(t[u],u,a(function(t){if(t)n(t);else{if(null===(u=o()))return n(null);r?L.setImmediate(i):i()}})),r=!1}n=s(n||r);var o=v(t=t||[]),u=o();i()},L.forEachOfLimit=L.eachOfLimit=function(t,e,n,r){b(e)(t,n,r)},L.map=w(_),L.mapSeries=x(_),L.mapLimit=k(_),L.inject=L.foldl=L.reduce=function(t,e,n,r){L.eachOfSeries(t,function(t,r,i){n(e,t,function(t,n){e=n,i(t)})},function(t){r(t,e)})},L.foldr=L.reduceRight=function(t,e,n,r){var o=l(t,i).reverse();L.reduce(o,e,n,r)},L.transform=function(t,e,n,r){3===arguments.length&&(r=n,n=e,e=z(t)?[]:{}),L.eachOf(t,function(t,r,i){n(e,t,r,i)},function(t){r(t,e)})},L.select=L.filter=w(E),L.selectLimit=L.filterLimit=k(E),L.selectSeries=L.filterSeries=x(E),L.reject=w(O),L.rejectLimit=k(O),L.rejectSeries=x(O),L.any=L.some=S(L.eachOf,o,i),L.someLimit=S(L.eachOfLimit,o,i),L.all=L.every=S(L.eachOf,u,u),L.everyLimit=S(L.eachOfLimit,u,u),L.detect=S(L.eachOf,i,A),L.detectSeries=S(L.eachOfSeries,i,A),L.detectLimit=S(L.eachOfLimit,i,A),L.sortBy=function(t,e,n){function r(t,e){var n=t.criteria,r=e.criteria;return n<r?-1:n>r?1:0}L.map(t,function(t,n){e(t,function(e,r){e?n(e):n(null,{value:t,criteria:r})})},function(t,e){if(t)return n(t);n(null,l(e.sort(r),function(t){return t.value}))})},L.auto=function(t,e,n){function i(t){m.unshift(t)}function o(t){var e=y(m,t);e>=0&&m.splice(e,1)}function u(){c--,f(m.slice(0),function(t){t()})}"function"==typeof arguments[1]&&(n=e,e=null),n=s(n||r);var a=P(t),c=a.length;if(!c)return n(null);e||(e=c);var l={},h=0,v=!1,m=[];i(function(){c||n(null,l)}),f(a,function(r){function a(){return h<e&&p(b,function(t,e){return t&&l.hasOwnProperty(e)},!0)&&!l.hasOwnProperty(r)}function s(){a()&&(h++,o(s),f[f.length-1](m,l))}if(!v){for(var c,f=z(t[r])?t[r]:[t[r]],m=g(function(t,e){if(h--,e.length<=1&&(e=e[0]),t){var i={};d(l,function(t,e){i[e]=t}),i[r]=e,v=!0,n(t,i)}else l[r]=e,L.setImmediate(u)}),b=f.slice(0,f.length-1),w=b.length;w--;){if(!(c=t[b[w]]))throw new Error("Has nonexistent dependency in "+b.join(", "));if(z(c)&&y(c,r)>=0)throw new Error("Has cyclic dependencies")}a()?(h++,f[f.length-1](m,l)):i(s)}})},L.retry=function(t,e,n){function r(t,e){for(;a.times;){var n=!(a.times-=1);u.push(function(t,n){return function(r){t(function(t,e){r(!t||n,{err:t,result:e})},e)}}(a.task,n)),!n&&a.interval>0&&u.push(function(t){return function(e){setTimeout(function(){e(null)},t)}}(a.interval))}L.series(u,function(e,n){n=n[n.length-1],(t||a.callback)(n.err,n.result)})}var i=5,o=0,u=[],a={times:i,interval:o},s=arguments.length;if(s<1||s>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return s<=2&&"function"==typeof t&&(n=e,e=t),"function"!=typeof t&&function(t,e){if("number"==typeof e)t.times=parseInt(e,10)||i;else{if("object"!=typeof e)throw new Error("Unsupported argument type for 'times': "+typeof e);t.times=parseInt(e.times,10)||i,t.interval=parseInt(e.interval,10)||o}}(a,t),a.callback=n,a.task=e,a.callback?r():r},L.waterfall=function(t,e){function n(t){return g(function(r,i){if(r)e.apply(null,[r].concat(i));else{var o=t.next();o?i.push(n(o)):i.push(e),C(t).apply(null,i)}})}if(e=s(e||r),!z(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();n(L.iterator(t))()},L.parallel=function(t,e){j(L.eachOf,t,e)},L.parallelLimit=function(t,e,n){j(b(e),t,n)},L.series=function(t,e){j(L.eachOfSeries,t,e)},L.iterator=function(t){function e(n){function r(){return t.length&&t[n].apply(null,arguments),r.next()}return r.next=function(){return n<t.length-1?e(n+1):null},r}return e(0)},L.apply=g(function(t,e){return g(function(n){return t.apply(null,e.concat(n))})}),L.concat=w(I),L.concatSeries=x(I),L.whilst=function(t,e,n){if(n=n||r,t()){var i=g(function(r,o){r?n(r):t.apply(this,o)?e(i):n.apply(null,[null].concat(o))});e(i)}else n(null)},L.doWhilst=function(t,e,n){var r=0;return L.whilst(function(){return++r<=1||e.apply(this,arguments)},t,n)},L.until=function(t,e,n){return L.whilst(function(){return!t.apply(this,arguments)},e,n)},L.doUntil=function(t,e,n){return L.doWhilst(t,function(){return!e.apply(this,arguments)},n)},L.during=function(t,e,n){n=n||r;var i=g(function(e,r){e?n(e):(r.push(o),t.apply(this,r))}),o=function(t,r){t?n(t):r?e(i):n(null)};t(o)},L.doDuring=function(t,e,n){var r=0;L.during(function(t){r++<1?t(null,!0):e.apply(this,arguments)},t,n)},L.queue=function(t,e){return D(function(e,n){t(e[0],n)},e,1)},L.priorityQueue=function(t,e){function n(t,e){return t.priority-e.priority}function i(t,e,n){for(var r=-1,i=t.length-1;r<i;){var o=r+(i-r+1>>>1);n(e,t[o])>=0?r=o:i=o-1}return r}function o(t,e,o,u){if(null!=u&&"function"!=typeof u)throw new Error("task callback must be a function");if(t.started=!0,z(e)||(e=[e]),0===e.length)return L.setImmediate(function(){t.drain()});f(e,function(e){var a={data:e,priority:o,callback:"function"==typeof u?u:r};t.tasks.splice(i(t.tasks,a,n)+1,0,a),t.tasks.length===t.concurrency&&t.saturated(),L.setImmediate(t.process)})}var u=L.queue(t,e);return u.push=function(t,e,n){o(u,t,e,n)},delete u.unshift,u},L.cargo=function(t,e){return D(t,1,e)},L.log=$("log"),L.dir=$("dir"),L.memoize=function(t,e){var n={},r={},o=Object.prototype.hasOwnProperty;e=e||i;var u=g(function(i){var u=i.pop(),a=e.apply(null,i);o.call(n,a)?L.setImmediate(function(){u.apply(null,n[a])}):o.call(r,a)?r[a].push(u):(r[a]=[u],t.apply(null,i.concat([g(function(t){n[a]=t;var e=r[a];delete r[a];for(var i=0,o=e.length;i<o;i++)e[i].apply(null,t)})])))});return u.memo=n,u.unmemoized=t,u},L.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},L.times=N(L.map),L.timesSeries=N(L.mapSeries),L.timesLimit=function(t,e,n,r){return L.mapLimit(h(t),e,n,r)},L.seq=function(){var t=arguments;return g(function(e){var n=this,i=e[e.length-1];"function"==typeof i?e.pop():i=r,L.reduce(t,e,function(t,e,r){e.apply(n,t.concat([g(function(t,e){r(t,e)})]))},function(t,e){i.apply(n,[t].concat(e))})})},L.compose=function(){return L.seq.apply(null,Array.prototype.reverse.call(arguments))},L.applyEach=T(L.eachOf),L.applyEachSeries=T(L.eachOfSeries),L.forever=function(t,e){function n(t){if(t)return i(t);o(n)}var i=a(e||r),o=C(t);n()},L.ensureAsync=C,L.constant=g(function(t){var e=[null].concat(t);return function(t){return t.apply(this,e)}}),L.wrapSync=L.asyncify=function(t){return g(function(e){var n,r=e.pop();try{n=t.apply(this,e)}catch(t){return r(t)}F(n)&&"function"==typeof n.then?n.then(function(t){r(null,t)}).catch(function(t){r(t.message?t:new Error(t))}):r(null,n)})},"object"==typeof e&&e.exports?e.exports=L:B.async=L}()}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:18}],10:[function(t,e,n){e.exports.BinarySearchTree=t("./lib/bst"),e.exports.AVLTree=t("./lib/avltree")},{"./lib/avltree":11,"./lib/bst":12}],11:[function(t,e,n){function r(t){this.tree=new i(t)}function i(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||u.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||u.defaultCheckValueEquality}var o=t("./bst"),u=t("./customUtils"),a=t("util");t("underscore");a.inherits(i,o),r._AVLTree=i,i.prototype.checkHeightCorrect=function(){var t,e;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);if(t=this.left?this.left.height:0,e=this.right?this.right.height:0,this.height!==1+Math.max(t,e))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},i.prototype.balanceFactor=function(){return(this.left?this.left.height:0)-(this.right?this.right.height:0)},i.prototype.checkBalanceFactors=function(){if(Math.abs(this.balanceFactor())>1)throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},i.prototype.checkIsAVLT=function(){i.super_.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},r.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},i.prototype.rightRotation=function(){var t,e,n,r,i=this,o=this.left;return o?(t=o.right,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.right=i,i.parent=o,i.left=t,t&&(t.parent=i),e=o.left?o.left.height:0,n=t?t.height:0,r=i.right?i.right.height:0,i.height=Math.max(n,r)+1,o.height=Math.max(e,i.height)+1,o):this},i.prototype.leftRotation=function(){var t,e,n,r,i=this,o=this.right;return o?(t=o.left,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.left=i,i.parent=o,i.right=t,t&&(t.parent=i),e=i.left?i.left.height:0,n=t?t.height:0,r=o.right?o.right.height:0,i.height=Math.max(e,n)+1,o.height=Math.max(r,i.height)+1,o):this},i.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},i.prototype.leftTooSmall=function(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())},i.prototype.rebalanceAlongPath=function(t){var e,n,r=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(n=t.length-1;n>=0;n-=1)t[n].height=1+Math.max(t[n].left?t[n].left.height:0,t[n].right?t[n].right.height:0),t[n].balanceFactor()>1&&(e=t[n].rightTooSmall(),0===n&&(r=e)),t[n].balanceFactor()<-1&&(e=t[n].leftTooSmall(),0===n&&(r=e));return r},i.prototype.insert=function(t,e){var n=[],r=this;if(!this.hasOwnProperty("key"))return this.key=t,this.data.push(e),this.height=1,this;for(;;){if(0===r.compareKeys(r.key,t)){if(r.unique){var i=new Error("Can't insert key "+t+", it violates the unique constraint");throw i.key=t,i.errorType="uniqueViolated",i}return r.data.push(e),this}if(n.push(r),r.compareKeys(t,r.key)<0){if(!r.left){n.push(r.createLeftChild({key:t,value:e}));break}r=r.left}else{if(!r.right){n.push(r.createRightChild({key:t,value:e}));break}r=r.right}}return this.rebalanceAlongPath(n)},r.prototype.insert=function(t,e){var n=this.tree.insert(t,e);n&&(this.tree=n)},i.prototype.delete=function(t,e){var n,r=[],i=this,o=[];if(!this.hasOwnProperty("key"))return this;for(;;){if(0===i.compareKeys(t,i.key))break;if(o.push(i),i.compareKeys(t,i.key)<0){if(!i.left)return this;i=i.left}else{if(!i.right)return this;i=i.right}}if(i.data.length>1&&void 0!==e)return i.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),i.data=r,this;if(!i.left&&!i.right)return i===this?(delete i.key,i.data=[],delete i.height,this):(i.parent.left===i?i.parent.left=null:i.parent.right=null,this.rebalanceAlongPath(o));if(!i.left||!i.right)return n=i.left?i.left:i.right,i===this?(n.parent=null,n):(i.parent.left===i?(i.parent.left=n,n.parent=i.parent):(i.parent.right=n,n.parent=i.parent),this.rebalanceAlongPath(o));if(o.push(i),!(n=i.left).right)return i.key=n.key,i.data=n.data,i.left=n.left,n.left&&(n.left.parent=i),this.rebalanceAlongPath(o);for(;;){if(!n.right)break;o.push(n),n=n.right}return i.key=n.key,i.data=n.data,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(o)},r.prototype.delete=function(t,e){var n=this.tree.delete(t,e);n&&(this.tree=n)},["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach(function(t){r.prototype[t]=function(){return this.tree[t].apply(this.tree,arguments)}}),e.exports=r},{"./bst":12,"./customUtils":13,underscore:15,util:21}],12:[function(t,e,n){function r(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||o.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||o.defaultCheckValueEquality}function i(t,e){var n;for(n=0;n<e.length;n+=1)t.push(e[n])}var o=t("./customUtils");r.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},r.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},r.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},r.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},r.prototype.checkAllNodesFullfillCondition=function(t){this.hasOwnProperty("key")&&(t(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(t),this.right&&this.right.checkAllNodesFullfillCondition(t))},r.prototype.checkNodeOrdering=function(){var t=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)>=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)<=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.right.checkNodeOrdering()))},r.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.right.checkInternalPointers()}},r.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")},r.prototype.getNumberOfKeys=function(){var t;return this.hasOwnProperty("key")?(t=1,this.left&&(t+=this.left.getNumberOfKeys()),this.right&&(t+=this.right.getNumberOfKeys()),t):0},r.prototype.createSimilar=function(t){return t=t||{},t.unique=this.unique,t.compareKeys=this.compareKeys,t.checkValueEquality=this.checkValueEquality,new this.constructor(t)},r.prototype.createLeftChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.left=e,e},r.prototype.createRightChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.right=e,e},r.prototype.insert=function(t,e){if(!this.hasOwnProperty("key"))return this.key=t,void this.data.push(e);if(0!==this.compareKeys(this.key,t))this.compareKeys(t,this.key)<0?this.left?this.left.insert(t,e):this.createLeftChild({key:t,value:e}):this.right?this.right.insert(t,e):this.createRightChild({key:t,value:e});else{if(this.unique){var n=new Error("Can't insert key "+t+", it violates the unique constraint");throw n.key=t,n.errorType="uniqueViolated",n}this.data.push(e)}},r.prototype.search=function(t){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,t)?this.data:this.compareKeys(t,this.key)<0?this.left?this.left.search(t):[]:this.right?this.right.search(t):[]:[]},r.prototype.getLowerBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$gt")||t.hasOwnProperty("$gte")?t.hasOwnProperty("$gt")&&t.hasOwnProperty("$gte")?0===e.compareKeys(t.$gte,t.$gt)?function(n){return e.compareKeys(n,t.$gt)>0}:e.compareKeys(t.$gte,t.$gt)>0?function(n){return e.compareKeys(n,t.$gte)>=0}:function(n){return e.compareKeys(n,t.$gt)>0}:t.hasOwnProperty("$gt")?function(n){return e.compareKeys(n,t.$gt)>0}:function(n){return e.compareKeys(n,t.$gte)>=0}:function(){return!0}},r.prototype.getUpperBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$lt")||t.hasOwnProperty("$lte")?t.hasOwnProperty("$lt")&&t.hasOwnProperty("$lte")?0===e.compareKeys(t.$lte,t.$lt)?function(n){return e.compareKeys(n,t.$lt)<0}:e.compareKeys(t.$lte,t.$lt)<0?function(n){return e.compareKeys(n,t.$lte)<=0}:function(n){return e.compareKeys(n,t.$lt)<0}:t.hasOwnProperty("$lt")?function(n){return e.compareKeys(n,t.$lt)<0}:function(n){return e.compareKeys(n,t.$lte)<=0}:function(){return!0}},r.prototype.betweenBounds=function(t,e,n){var r=[];return this.hasOwnProperty("key")?(e=e||this.getLowerBoundMatcher(t),n=n||this.getUpperBoundMatcher(t),e(this.key)&&this.left&&i(r,this.left.betweenBounds(t,e,n)),e(this.key)&&n(this.key)&&i(r,this.data),n(this.key)&&this.right&&i(r,this.right.betweenBounds(t,e,n)),r):[]},r.prototype.deleteIfLeaf=function(){return!this.left&&!this.right&&(this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.data=[],!0))},r.prototype.deleteIfOnlyOneChild=function(){var t;return this.left&&!this.right&&(t=this.left),!this.left&&this.right&&(t=this.right),!!t&&(this.parent?(this.parent.left===this?(this.parent.left=t,t.parent=this.parent):(this.parent.right=t,t.parent=this.parent),!0):(this.key=t.key,this.data=t.data,this.left=null,t.left&&(this.left=t.left,t.left.parent=this),this.right=null,t.right&&(this.right=t.right,t.right.parent=this),!0))},r.prototype.delete=function(t,e){var n,r=[],i=this;if(this.hasOwnProperty("key"))if(this.compareKeys(t,this.key)<0)this.left&&this.left.delete(t,e);else if(this.compareKeys(t,this.key)>0)this.right&&this.right.delete(t,e);else if(0!==!this.compareKeys(t,this.key))return this.data.length>1&&void 0!==e?(this.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),void(i.data=r)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(n=this.left.getMaxKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.left=n.left,n.left&&(n.left.parent=n.parent)):(n.parent.right=n.left,n.left&&(n.left.parent=n.parent))):(n=this.right.getMinKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.right=n.right,n.right&&(n.right.parent=n.parent)):(n.parent.left=n.right,n.right&&(n.right.parent=n.parent)))))},r.prototype.executeOnEveryNode=function(t){this.left&&this.left.executeOnEveryNode(t),t(this),this.right&&this.right.executeOnEveryNode(t)},r.prototype.prettyPrint=function(t,e){e=e||"",console.log(e+"* "+this.key),t&&console.log(e+"* "+this.data),(this.left||this.right)&&(this.left?this.left.prettyPrint(t,e+"  "):console.log(e+"  *"),this.right?this.right.prettyPrint(t,e+"  "):console.log(e+"  *"))},e.exports=r},{"./customUtils":13}],13:[function(t,e,n){function r(t){var e,n;return 0===t?[]:1===t?[0]:(e=r(t-1),n=Math.floor(Math.random()*t),e.splice(n,0,t-1),e)}e.exports.getRandomArray=r,e.exports.defaultCompareKeysFunction=function(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;var n=new Error("Couldn't compare elements");throw n.a=t,n.b=e,n},e.exports.defaultCheckValueEquality=function(t,e){return t===e}},{}],14:[function(t,e,n){(function(r){!function(t){if("object"==typeof n&&void 0!==e)e.exports=t();else{("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).localforage=t()}}(function(){return function e(n,r,i){function o(a,s){if(!r[a]){if(!n[a]){var c="function"==typeof t&&t;if(!s&&c)return c(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[a]={exports:{}};n[a][0].call(l.exports,function(t){var e=n[a][1][t];return o(e||t)},l,l.exports,e,n,r,i)}return r[a].exports}for(var u="function"==typeof t&&t,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){(function(t){"use strict";function n(){c=!0;for(var t,e,n=f.length;n;){for(e=f,f=[],t=-1;++t<n;)e[t]();n=f.length}c=!1}var r,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,u=new i(n),a=t.document.createTextNode("");u.observe(a,{characterData:!0}),r=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){n(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(n,0)};else{var s=new t.MessageChannel;s.port1.onmessage=n,r=function(){s.port2.postMessage(0)}}var c,f=[];e.exports=function(t){1!==f.push(t)||c||r()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";function r(){}function i(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,t!==r&&s(this,t)}function o(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(t,e,n){f(function(){var r;try{r=e(n)}catch(e){return l.reject(t,e)}r===t?l.reject(t,new TypeError("Cannot resolve promise with itself")):l.resolve(t,r)})}function a(t){var e=t&&t.then;if(t&&"object"==typeof t&&"function"==typeof e)return function(){e.apply(t,arguments)}}function s(t,e){function n(e){i||(i=!0,l.reject(t,e))}function r(e){i||(i=!0,l.resolve(t,e))}var i=!1,o=c(function(){e(r,n)});"error"===o.status&&n(o.value)}function c(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}var f=t(1),l={},h=["REJECTED"],p=["FULFILLED"],d=["PENDING"];e.exports=n=i,i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){if("function"!=typeof t&&this.state===p||"function"!=typeof e&&this.state===h)return this;var n=new this.constructor(r);return this.state!==d?u(n,this.state===p?t:e,this.outcome):this.queue.push(new o(n,t,e)),n},o.prototype.callFulfilled=function(t){l.resolve(this.promise,t)},o.prototype.otherCallFulfilled=function(t){u(this.promise,this.onFulfilled,t)},o.prototype.callRejected=function(t){l.reject(this.promise,t)},o.prototype.otherCallRejected=function(t){u(this.promise,this.onRejected,t)},l.resolve=function(t,e){var n=c(a,e);if("error"===n.status)return l.reject(t,n.value);var r=n.value;if(r)s(t,r);else{t.state=p,t.outcome=e;for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callFulfilled(e)}return t},l.reject=function(t,e){t.state=h,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},n.resolve=function(t){return t instanceof this?t:l.resolve(new this(r),t)},n.reject=function(t){var e=new this(r);return l.reject(e,t)},n.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),u=0,a=-1,s=new this(r);++a<n;)!function(t,r){e.resolve(t).then(function(t){o[r]=t,++u!==n||i||(i=!0,l.resolve(s,o))},function(t){i||(i=!0,l.reject(s,t))})}(t[a],a);return s},n.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var o=-1,u=new this(r);++o<n;)!function(t){e.resolve(t).then(function(t){i||(i=!0,l.resolve(u,t))},function(t){i||(i=!0,l.reject(u,t))})}(t[o]);return u}},{1:1}],3:[function(t,e,n){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}function o(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function u(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function a(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}function s(t){return new D(function(e){var n=t.transaction($,"readwrite"),r=i([""]);n.objectStore($).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}function c(t){return"boolean"==typeof j?D.resolve(j):s(t).then(function(t){return j=t})}function f(t){var e=I[t.name],n={};n.promise=new D(function(t){n.resolve=t}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function l(t){var e=I[t.name].deferredOperations.pop();e&&e.resolve()}function h(t,e){return new D(function(n,r){if(t.db){if(!e)return n(t.db);f(t),t.db.close()}var i=[t.name];e&&i.push(t.version);var o=A.open.apply(A,i);e&&(o.onupgradeneeded=function(e){var n=o.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore($)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),o.onerror=function(t){t.preventDefault(),r(o.error)},o.onsuccess=function(){n(o.result),l(t)}})}function p(t){return h(t,!1)}function d(t){return h(t,!0)}function y(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,i=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),i||n){if(n){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function v(t){return new D(function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)})}function g(t){return i([a(atob(t.data))],{type:t.type})}function m(t){return t&&t.__local_forage_encoded_blob}function b(t){var e=this,n=e._initReady().then(function(){var t=I[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return u(n,t,t),n}function w(t){var e,n,r,i,o,u=.75*t.length,a=t.length,s=0;"="===t[t.length-1]&&(u--,"="===t[t.length-2]&&u--);var c=new ArrayBuffer(u),f=new Uint8Array(c);for(e=0;e<a;e+=4)n=C.indexOf(t[e]),r=C.indexOf(t[e+1]),i=C.indexOf(t[e+2]),o=C.indexOf(t[e+3]),f[s++]=n<<2|r>>4,f[s++]=(15&r)<<4|i>>2,f[s++]=(3&i)<<6|63&o;return c}function k(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=C[n[e]>>2],r+=C[(3&n[e])<<4|n[e+1]>>4],r+=C[(15&n[e+1])<<2|n[e+2]>>6],r+=C[63&n[e+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function x(t,e,n,r){var i=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var u=new D(function(o,u){i.ready().then(function(){void 0===e&&(e=null);var a=e,s=i._dbInfo;s.serializer.serialize(e,function(e,c){c?u(c):s.db.transaction(function(n){n.executeSql("INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){o(a)},function(t,e){u(e)})},function(e){if(e.code===e.QUOTA_ERR){if(r>0)return void o(x.apply(i,[t,a,n,r-1]));u(e)}})})}).catch(u)});return o(u,n),u}function _(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function E(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(ut(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}function O(t){for(var e in nt)if(nt.hasOwnProperty(e)&&nt[e]===t)return!0;return!1}var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){}}();"undefined"==typeof Promise&&t(3);var j,I,D=Promise,$="local-forage-detect-blob-support",N=Object.prototype.toString,T={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];I||(I={});var i=I[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},I[n.name]=i),i.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=b);for(var o=[],u=0;u<i.forages.length;u++){var a=i.forages[u];a!==e&&o.push(a._initReady().catch(function(){return D.resolve()}))}var s=i.forages.slice(0);return D.all(o).then(function(){return n.db=i.db,p(n)}).then(function(t){return n.db=t,y(n,e._defaultConfig.version)?d(n):t}).then(function(t){n.db=i.db=t,e._dbInfo=n;for(var r=0;r<s.length;r++){var o=s[r];o!==e&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})},iterate:function(t,e){var n=this,r=new D(function(e,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).openCursor(),u=1;o.onsuccess=function(){var n=o.result;if(n){var r=n.value;m(r)&&(r=g(r));var i=t(r,n.key,u++);void 0!==i?e(i):n.continue()}else e()},o.onerror=function(){r(o.error)}}).catch(r)});return o(r,e),r},getItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new D(function(e,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).get(t);o.onsuccess=function(){var t=o.result;void 0===t&&(t=null),m(t)&&(t=g(t)),e(t)},o.onerror=function(){r(o.error)}}).catch(r)});return o(r,e),r},setItem:function(t,e,n){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new D(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===N.call(e)?c(o.db).then(function(t){return t?e:v(e)}):e}).then(function(e){var r=o.db.transaction(o.storeName,"readwrite"),u=r.objectStore(o.storeName).put(e,t);null===e&&(e=void 0),r.oncomplete=function(){void 0===e&&(e=null),n(e)},r.onabort=r.onerror=function(){var t=u.error?u.error:u.transaction.error;i(t)}}).catch(i)});return o(i,n),i},removeItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new D(function(e,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readwrite"),u=o.objectStore(i.storeName).delete(t);o.oncomplete=function(){e()},o.onerror=function(){r(u.error)},o.onabort=function(){var t=u.error?u.error:u.transaction.error;r(t)}}).catch(r)});return o(r,e),r},clear:function(t){var e=this,n=new D(function(t,n){e.ready().then(function(){var r=e._dbInfo,i=r.db.transaction(r.storeName,"readwrite"),o=i.objectStore(r.storeName).clear();i.oncomplete=function(){t()},i.onabort=i.onerror=function(){var t=o.error?o.error:o.transaction.error;n(t)}}).catch(n)});return o(n,t),n},length:function(t){var e=this,n=new D(function(t,n){e.ready().then(function(){var r=e._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}}).catch(n)});return o(n,t),n},key:function(t,e){var n=this,r=new D(function(e,r){t<0?e(null):n.ready().then(function(){var i=n._dbInfo,o=!1,u=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).openCursor();u.onsuccess=function(){var n=u.result;n?0===t?e(n.key):o?e(n.key):(o=!0,n.advance(t)):e(null)},u.onerror=function(){r(u.error)}}).catch(r)});return o(r,e),r},keys:function(t){var e=this,n=new D(function(t,n){e.ready().then(function(){var r=e._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).openCursor(),o=[];i.onsuccess=function(){var e=i.result;e?(o.push(e.key),e.continue()):t(o)},i.onerror=function(){n(i.error)}}).catch(n)});return o(n,t),n}},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M="~~local_forage_type~",L=/^~~local_forage_type~([^~]+)~/,B="__lfsc__:",R=B.length,z="arbf",F="blob",P="si08",q="ui08",K="uic8",U="si16",V="si32",W="ur16",H="ui32",J="fl32",Q="fl64",G=R+z.length,X=Object.prototype.toString,Y={serialize:function(t,e){var n="";if(t&&(n=X.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===X.call(t.buffer))){var r,i=B;t instanceof ArrayBuffer?(r=t,i+=z):(r=t.buffer,"[object Int8Array]"===n?i+=P:"[object Uint8Array]"===n?i+=q:"[object Uint8ClampedArray]"===n?i+=K:"[object Int16Array]"===n?i+=U:"[object Uint16Array]"===n?i+=W:"[object Int32Array]"===n?i+=V:"[object Uint32Array]"===n?i+=H:"[object Float32Array]"===n?i+=J:"[object Float64Array]"===n?i+=Q:e(new Error("Failed to get type for BinaryArray"))),e(i+k(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=M+t.type+"~"+k(this.result);e(B+F+n)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,R)!==B)return JSON.parse(t);var e,n=t.substring(G),r=t.substring(R,G);if(r===F&&L.test(n)){var o=n.match(L);e=o[1],n=n.substring(o[0].length)}var u=w(n);switch(r){case z:return u;case F:return i([u],{type:e});case P:return new Int8Array(u);case q:return new Uint8Array(u);case K:return new Uint8ClampedArray(u);case U:return new Int16Array(u);case W:return new Uint16Array(u);case V:return new Int32Array(u);case H:return new Uint32Array(u);case J:return new Float32Array(u);case Q:return new Float64Array(u);default:throw new Error("Unkown type: "+r)}},stringToBuffer:w,bufferToString:k},Z={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var i=new D(function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction(function(i){i.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){e._dbInfo=n,t()},function(t,e){r(e)})})});return n.serializer=Y,i},iterate:function(t,e){var n=this,r=new D(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,u=o.length,a=0;a<u;a++){var s=o.item(a),c=s.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=t(c,s.key,a+1)))return void e(c)}e()},function(t,e){r(e)})})}).catch(r)});return o(r,e),r},getItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new D(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})}).catch(r)});return o(r,e),r},setItem:function(t,e,n){return x.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new D(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})}).catch(r)});return o(r,e),r},clear:function(t){var e=this,n=new D(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return o(n,t),n},length:function(t){var e=this,n=new D(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return o(n,t),n},key:function(t,e){var n=this,r=new D(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return o(r,e),r},keys:function(t){var e=this,n=new D(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);t(r)},function(t,e){n(e)})})}).catch(n)});return o(n,t),n}},tt={_driver:"localStorageWrapper",_initStorage:function(t){var e=this,n={};if(t)for(var r in t)n[r]=t[r];return n.keyPrefix=n.name+"/",n.storeName!==e._defaultConfig.storeName&&(n.keyPrefix+=n.storeName+"/"),e._dbInfo=n,n.serializer=Y,D.resolve()},iterate:function(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,i=r.length,o=localStorage.length,u=1,a=0;a<o;a++){var s=localStorage.key(a);if(0===s.indexOf(r)){var c=localStorage.getItem(s);if(c&&(c=e.serializer.deserialize(c)),void 0!==(c=t(c,s.substring(i),u++)))return c}}});return o(r,e),r},getItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return o(r,e),r},setItem:function(t,e,n){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new D(function(i,o){var u=r._dbInfo;u.serializer.serialize(e,function(e,r){if(r)o(r);else try{localStorage.setItem(u.keyPrefix+t,e),i(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}})})});return o(i,n),i},removeItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return o(r,e),r},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}});return o(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return o(e,t),e},key:function(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return o(r,e),r},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++)0===localStorage.key(i).indexOf(t.keyPrefix)&&r.push(localStorage.key(i).substring(t.keyPrefix.length));return r});return o(n,t),n}},et={},nt={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},rt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],it={description:"",driver:[nt.INDEXEDDB,nt.WEBSQL,nt.LOCALSTORAGE].slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},ot={};ot[nt.INDEXEDDB]=function(){try{if(!A)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),ot[nt.WEBSQL]="function"==typeof openDatabase,ot[nt.LOCALSTORAGE]=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(t){return!1}}();var ut=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},at=new(function(){function t(e){r(this,t),this.INDEXEDDB=nt.INDEXEDDB,this.LOCALSTORAGE=nt.LOCALSTORAGE,this.WEBSQL=nt.WEBSQL,this._defaultConfig=E({},it),this._config=E({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":S(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new D(function(e,n){try{var r=t._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),o=new Error("Custom driver name already in use: "+t._driver);if(!t._driver)return void n(i);if(O(t._driver))return void n(o);for(var u=rt.concat("_initStorage"),a=0;a<u.length;a++){var s=u[a];if(!s||!t[s]||"function"!=typeof t[s])return void n(i)}var c=D.resolve(!0);"_support"in t&&(c=t._support&&"function"==typeof t._support?t._support():D.resolve(!!t._support)),c.then(function(n){ot[r]=n,et[r]=t,e()},n)}catch(t){n(t)}});return u(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=this,i=D.resolve().then(function(){if(!O(t)){if(et[t])return et[t];throw new Error("Driver not found.")}switch(t){case r.INDEXEDDB:return T;case r.LOCALSTORAGE:return tt;case r.WEBSQL:return Z}});return u(i,e,n),i},t.prototype.getSerializer=function(t){var e=D.resolve(Y);return u(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return u(n,t,t),n},t.prototype.setDriver=function(t,e,n){function r(){a._config.driver=a.driver()}function i(t){return a._extend(t),r(),a._ready=a._initStorage(a._config),a._ready}function o(t){return function(){function e(){for(;n<t.length;){var o=t[n];return n++,a._dbInfo=null,a._ready=null,a.getDriver(o).then(i).catch(e)}r();var u=new Error("No available storage method found.");return a._driverSet=D.reject(u),a._driverSet}var n=0;return e()}}var a=this;ut(t)||(t=[t]);var s=this._getSupportedDrivers(t),c=null!==this._driverSet?this._driverSet.catch(function(){return D.resolve()}):D.resolve();return this._driverSet=c.then(function(){var t=s[0];return a._dbInfo=null,a._ready=null,a.getDriver(t).then(function(t){a._driver=t._driver,r(),a._wrapLibraryMethodsWithReady(),a._initDriver=o(s)})}).catch(function(){r();var t=new Error("No available storage method found.");return a._driverSet=D.reject(t),a._driverSet}),u(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!ot[t]},t.prototype._extend=function(t){E(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];this.supports(i)&&e.push(i)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0;t<rt.length;t++)_(this,rt[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.exports=at},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(t,e,n){(function(){var t=this,r=t._,i={},o=Array.prototype,u=Object.prototype,a=Function.prototype,s=o.push,c=o.slice,f=o.concat,l=u.toString,h=u.hasOwnProperty,p=o.forEach,d=o.map,y=o.reduce,v=o.reduceRight,g=o.filter,m=o.every,b=o.some,w=o.indexOf,k=o.lastIndexOf,x=Array.isArray,_=Object.keys,E=a.bind,O=function(t){return t instanceof O?t:this instanceof O?void(this._wrapped=t):new O(t)};void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=O),n._=O):t._=O,O.VERSION="1.4.4";var S=O.each=O.forEach=function(t,e,n){if(null!=t)if(p&&t.forEach===p)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,o=t.length;r<o;r++)if(e.call(n,t[r],r,t)===i)return}else for(var u in t)if(O.has(t,u)&&e.call(n,t[u],u,t)===i)return};O.map=O.collect=function(t,e,n){var r=[];return null==t?r:d&&t.map===d?t.map(e,n):(S(t,function(t,i,o){r[r.length]=e.call(n,t,i,o)}),r)};var A="Reduce of empty array with no initial value";O.reduce=O.foldl=O.inject=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),y&&t.reduce===y)return r&&(e=O.bind(e,r)),i?t.reduce(e,n):t.reduce(e);if(S(t,function(t,o,u){i?n=e.call(r,n,t,o,u):(n=t,i=!0)}),!i)throw new TypeError(A);return n},O.reduceRight=O.foldr=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return r&&(e=O.bind(e,r)),i?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var u=O.keys(t);o=u.length}if(S(t,function(a,s,c){s=u?u[--o]:--o,i?n=e.call(r,n,t[s],s,c):(n=t[s],i=!0)}),!i)throw new TypeError(A);return n},O.find=O.detect=function(t,e,n){var r;return j(t,function(t,i,o){if(e.call(n,t,i,o))return r=t,!0}),r},O.filter=O.select=function(t,e,n){var r=[];return null==t?r:g&&t.filter===g?t.filter(e,n):(S(t,function(t,i,o){e.call(n,t,i,o)&&(r[r.length]=t)}),r)},O.reject=function(t,e,n){return O.filter(t,function(t,r,i){return!e.call(n,t,r,i)},n)},O.every=O.all=function(t,e,n){e||(e=O.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,n):(S(t,function(t,o,u){if(!(r=r&&e.call(n,t,o,u)))return i}),!!r)};var j=O.some=O.any=function(t,e,n){e||(e=O.identity);var r=!1;return null==t?r:b&&t.some===b?t.some(e,n):(S(t,function(t,o,u){if(r||(r=e.call(n,t,o,u)))return i}),!!r)};O.contains=O.include=function(t,e){return null!=t&&(w&&t.indexOf===w?-1!=t.indexOf(e):j(t,function(t){return t===e}))},O.invoke=function(t,e){var n=c.call(arguments,2),r=O.isFunction(e);return O.map(t,function(t){return(r?e:t[e]).apply(t,n)})},O.pluck=function(t,e){return O.map(t,function(t){return t[e]})},O.where=function(t,e,n){return O.isEmpty(e)?n?null:[]:O[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},O.findWhere=function(t,e){return O.where(t,e,!0)},O.max=function(t,e,n){if(!e&&O.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&O.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return S(t,function(t,i,o){var u=e?e.call(n,t,i,o):t;u>=r.computed&&(r={value:t,computed:u})}),r.value},O.min=function(t,e,n){if(!e&&O.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&O.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return S(t,function(t,i,o){var u=e?e.call(n,t,i,o):t;u<r.computed&&(r={value:t,computed:u})}),r.value},O.shuffle=function(t){var e,n=0,r=[];return S(t,function(t){e=O.random(n++),r[n-1]=r[e],r[e]=t}),r};var I=function(t){return O.isFunction(t)?t:function(e){return e[t]}};O.sortBy=function(t,e,n){var r=I(e);return O.pluck(O.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var D=function(t,e,n,r){var i={},o=I(e||O.identity);return S(t,function(e,u){var a=o.call(n,e,u,t);r(i,a,e)}),i};O.groupBy=function(t,e,n){return D(t,e,n,function(t,e,n){(O.has(t,e)?t[e]:t[e]=[]).push(n)})},O.countBy=function(t,e,n){return D(t,e,n,function(t,e){O.has(t,e)||(t[e]=0),t[e]++})},O.sortedIndex=function(t,e,n,r){for(var i=(n=null==n?O.identity:I(n)).call(r,e),o=0,u=t.length;o<u;){var a=o+u>>>1;n.call(r,t[a])<i?o=a+1:u=a}return o},O.toArray=function(t){return t?O.isArray(t)?c.call(t):t.length===+t.length?O.map(t,O.identity):O.values(t):[]},O.size=function(t){return null==t?0:t.length===+t.length?t.length:O.keys(t).length},O.first=O.head=O.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:c.call(t,0,e)},O.initial=function(t,e,n){return c.call(t,0,t.length-(null==e||n?1:e))},O.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:c.call(t,Math.max(t.length-e,0))},O.rest=O.tail=O.drop=function(t,e,n){return c.call(t,null==e||n?1:e)},O.compact=function(t){return O.filter(t,O.identity)};var $=function(t,e,n){return S(t,function(t){O.isArray(t)?e?s.apply(n,t):$(t,e,n):n.push(t)}),n};O.flatten=function(t,e){return $(t,e,[])},O.without=function(t){return O.difference(t,c.call(arguments,1))},O.uniq=O.unique=function(t,e,n,r){O.isFunction(e)&&(r=n,n=e,e=!1);var i=n?O.map(t,n,r):t,o=[],u=[];return S(i,function(n,r){(e?r&&u[u.length-1]===n:O.contains(u,n))||(u.push(n),o.push(t[r]))}),o},O.union=function(){return O.uniq(f.apply(o,arguments))},O.intersection=function(t){var e=c.call(arguments,1);return O.filter(O.uniq(t),function(t){return O.every(e,function(e){return O.indexOf(e,t)>=0})})},O.difference=function(t){var e=f.apply(o,c.call(arguments,1));return O.filter(t,function(t){return!O.contains(e,t)})},O.zip=function(){for(var t=c.call(arguments),e=O.max(O.pluck(t,"length")),n=new Array(e),r=0;r<e;r++)n[r]=O.pluck(t,""+r);return n},O.object=function(t,e){if(null==t)return{};for(var n={},r=0,i=t.length;r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},O.indexOf=function(t,e,n){if(null==t)return-1;var r=0,i=t.length;if(n){if("number"!=typeof n)return r=O.sortedIndex(t,e),t[r]===e?r:-1;r=n<0?Math.max(0,i+n):n}if(w&&t.indexOf===w)return t.indexOf(e,n);for(;r<i;r++)if(t[r]===e)return r;return-1},O.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(k&&t.lastIndexOf===k)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var i=r?n:t.length;i--;)if(t[i]===e)return i;return-1},O.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=0,o=new Array(r);i<r;)o[i++]=t,t+=n;return o},O.bind=function(t,e){if(t.bind===E&&E)return E.apply(t,c.call(arguments,1));var n=c.call(arguments,2);return function(){return t.apply(e,n.concat(c.call(arguments)))}},O.partial=function(t){var e=c.call(arguments,1);return function(){return t.apply(this,e.concat(c.call(arguments)))}},O.bindAll=function(t){var e=c.call(arguments,1);return 0===e.length&&(e=O.functions(t)),S(e,function(e){t[e]=O.bind(t[e],t)}),t},O.memoize=function(t,e){var n={};return e||(e=O.identity),function(){var r=e.apply(this,arguments);return O.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},O.delay=function(t,e){var n=c.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},O.defer=function(t){return O.delay.apply(O,[t,1].concat(c.call(arguments,1)))},O.throttle=function(t,e){var n,r,i,o,u=0,a=function(){u=new Date,i=null,o=t.apply(n,r)};return function(){var s=new Date,c=e-(s-u);return n=this,r=arguments,c<=0?(clearTimeout(i),i=null,u=s,o=t.apply(n,r)):i||(i=setTimeout(a,c)),o}},O.debounce=function(t,e,n){var r,i;return function(){var o=this,u=arguments,a=n&&!r;return clearTimeout(r),r=setTimeout(function(){r=null,n||(i=t.apply(o,u))},e),a&&(i=t.apply(o,u)),i}},O.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},O.wrap=function(t,e){return function(){var n=[t];return s.apply(n,arguments),e.apply(this,n)}},O.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},O.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},O.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)O.has(t,n)&&(e[e.length]=n);return e},O.values=function(t){var e=[];for(var n in t)O.has(t,n)&&e.push(t[n]);return e},O.pairs=function(t){var e=[];for(var n in t)O.has(t,n)&&e.push([n,t[n]]);return e},O.invert=function(t){var e={};for(var n in t)O.has(t,n)&&(e[t[n]]=n);return e},O.functions=O.methods=function(t){var e=[];for(var n in t)O.isFunction(t[n])&&e.push(n);return e.sort()},O.extend=function(t){return S(c.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},O.pick=function(t){var e={},n=f.apply(o,c.call(arguments,1));return S(n,function(n){n in t&&(e[n]=t[n])}),e},O.omit=function(t){var e={},n=f.apply(o,c.call(arguments,1));for(var r in t)O.contains(n,r)||(e[r]=t[r]);return e},O.defaults=function(t){return S(c.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},O.clone=function(t){return O.isObject(t)?O.isArray(t)?t.slice():O.extend({},t):t},O.tap=function(t,e){return e(t),t};var N=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof O&&(t=t._wrapped),e instanceof O&&(e=e._wrapped);var i=l.call(t);if(i!=l.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return r[o]==e;n.push(t),r.push(e);var u=0,a=!0;if("[object Array]"==i){if(u=t.length,a=u==e.length)for(;u--&&(a=N(t[u],e[u],n,r)););}else{var s=t.constructor,c=e.constructor;if(s!==c&&!(O.isFunction(s)&&s instanceof s&&O.isFunction(c)&&c instanceof c))return!1;for(var f in t)if(O.has(t,f)&&(u++,!(a=O.has(e,f)&&N(t[f],e[f],n,r))))break;if(a){for(f in e)if(O.has(e,f)&&!u--)break;a=!u}}return n.pop(),r.pop(),a};O.isEqual=function(t,e){return N(t,e,[],[])},O.isEmpty=function(t){if(null==t)return!0;if(O.isArray(t)||O.isString(t))return 0===t.length;for(var e in t)if(O.has(t,e))return!1;return!0},O.isElement=function(t){return!(!t||1!==t.nodeType)},O.isArray=x||function(t){return"[object Array]"==l.call(t)},O.isObject=function(t){return t===Object(t)},S(["Arguments","Function","String","Number","Date","RegExp"],function(t){O["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),O.isArguments(arguments)||(O.isArguments=function(t){return!(!t||!O.has(t,"callee"))}),"function"!=typeof/./&&(O.isFunction=function(t){return"function"==typeof t}),O.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},O.isNaN=function(t){return O.isNumber(t)&&t!=+t},O.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==l.call(t)},O.isNull=function(t){return null===t},O.isUndefined=function(t){return void 0===t},O.has=function(t,e){return h.call(t,e)},O.noConflict=function(){return t._=r,this},O.identity=function(t){return t},O.times=function(t,e,n){for(var r=Array(t),i=0;i<t;i++)r[i]=e.call(n,i);return r},O.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};T.unescape=O.invert(T.escape);var C={escape:new RegExp("["+O.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+O.keys(T.unescape).join("|")+")","g")};O.each(["escape","unescape"],function(t){O[t]=function(e){return null==e?"":(""+e).replace(C[t],function(e){return T[t][e]})}}),O.result=function(t,e){if(null==t)return null;var n=t[e];return O.isFunction(n)?n.call(t):n},O.mixin=function(t){S(O.functions(t),function(e){var n=O[e]=t[e];O.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),z.call(this,n.apply(O,t))}})};var M=0;O.uniqueId=function(t){var e=++M+"";return t?t+e:e},O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;O.template=function(t,e,n){var r;n=O.defaults({},n,O.templateSettings);var i=new RegExp([(n.escape||L).source,(n.interpolate||L).source,(n.evaluate||L).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(i,function(e,n,r,i,a){return u+=t.slice(o,a).replace(R,function(t){return"\\"+B[t]}),n&&(u+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(u+="';\n"+i+"\n__p+='"),o=a+e.length,e}),u+="';\n",n.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{r=new Function(n.variable||"obj","_",u)}catch(t){throw t.source=u,t}if(e)return r(e,O);var a=function(t){return r.call(this,t,O)};return a.source="function("+(n.variable||"obj")+"){\n"+u+"}",a},O.chain=function(t){return O(t).chain()};var z=function(t){return this._chain?O(t).chain():t};O.mixin(O),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];O.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],z.call(this,n)}}),S(["concat","join","slice"],function(t){var e=o[t];O.prototype[t]=function(){return z.call(this,e.apply(this._wrapped,arguments))}}),O.extend(O.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],16:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function u(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,o,s,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var f=new Error('Uncaught, unspecified "error" event. ('+e+")");throw f.context=e,f}if(n=this._events[t],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(u(n))for(o=Array.prototype.slice.call(arguments,1),r=(c=n.slice()).length,s=0;s<r;s++)c[s].apply(this,o);return!0},r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?u(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,u(this._events[t])&&!this._events[t].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,o,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(u(n)){for(a=o;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],17:[function(t,e,n){(function(t){function e(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return i.exec(t).slice(1)};n.resolve=function(){for(var n="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var u=o>=0?arguments[o]:t.cwd();if("string"!=typeof u)throw new TypeError("Arguments to path.resolve must be strings");u&&(n=u+"/"+n,i="/"===u.charAt(0))}return n=e(r(n.split("/"),function(t){return!!t}),!i).join("/"),(i?"/":"")+n||"."},n.normalize=function(t){var i=n.isAbsolute(t),o="/"===u(t,-1);return(t=e(r(t.split("/"),function(t){return!!t}),!i).join("/"))||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var i=r(t.split("/")),o=r(e.split("/")),u=Math.min(i.length,o.length),a=u,s=0;s<u;s++)if(i[s]!==o[s]){a=s;break}for(var c=[],s=a;s<i.length;s++)c.push("..");return(c=c.concat(o.slice(a))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=o(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return o(t)[3]};var u="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:18}],18:[function(t,e,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function u(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function a(){v&&d&&(v=!1,d.length?y=d.concat(y):g=-1,y.length&&s())}function s(){if(!v){var t=o(a);v=!0;for(var e=y.length;e;){for(d=y,y=[];++g<e;)d&&d[g].run();g=-1,e=y.length}d=null,v=!1,u(t)}}function c(t,e){this.fun=t,this.array=e}function f(){}var l,h,p=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(t){l=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var d,y=[],v=!1,g=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];y.push(new c(t,e)),1!==y.length||v||o(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=f,p.addListener=f,p.once=f,p.off=f,p.removeListener=f,p.removeAllListeners=f,p.emit=f,p.prependListener=f,p.prependOnceListener=f,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],19:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],20:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],21:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(e)?r.showHidden=e:e&&n._extend(r,e),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),s(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function u(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function s(t,e,r){if(t.customInspect&&e&&E(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return m(i)||(i=s(t,i,r)),i}var o=c(t,e);if(o)return o;var u=Object.keys(e),y=a(u);if(t.showHidden&&(u=Object.getOwnPropertyNames(e)),_(e)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return f(e);if(0===u.length){if(E(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(x(e))return t.stylize(Date.prototype.toString.call(e),"date");if(_(e))return f(e)}var g="",b=!1,k=["{","}"];if(d(e)&&(b=!0,k=["[","]"]),E(e)&&(g=" [Function"+(e.name?": "+e.name:"")+"]"),w(e)&&(g=" "+RegExp.prototype.toString.call(e)),x(e)&&(g=" "+Date.prototype.toUTCString.call(e)),_(e)&&(g=" "+f(e)),0===u.length&&(!b||0==e.length))return k[0]+g+k[1];if(r<0)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var O;return O=b?l(t,e,r,y,u):u.map(function(n){return h(t,e,r,y,n,b)}),t.seen.pop(),p(O,g,k)}function c(t,e){if(b(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,i){for(var o=[],u=0,a=e.length;u<a;++u)j(e,String(u))?o.push(h(t,e,n,r,String(u),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}function h(t,e,n,r,i,o){var u,a,c;if((c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),j(r,i)||(u="["+i+"]"),a||(t.seen.indexOf(c.value)<0?(a=v(n)?s(t,c.value,null):s(t,c.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),b(u)){if(o&&i.match(/^\d+$/))return a;(u=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=t.stylize(u,"string"))}return u+": "+a}function p(t,e,n){var r=0;return t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function v(t){return null===t}function g(t){return"number"==typeof t}function m(t){return"string"==typeof t}function b(t){return void 0===t}function w(t){return k(t)&&"[object RegExp]"===O(t)}function k(t){return"object"==typeof t&&null!==t}function x(t){return k(t)&&"[object Date]"===O(t)}function _(t){return k(t)&&("[object Error]"===O(t)||t instanceof Error)}function E(t){return"function"==typeof t}function O(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),N[t.getMonth()],e].join(" ")}function j(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var I=/%[sdj%]/g;n.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,u=String(t).replace(I,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];n<o;a=r[++n])v(a)||!k(a)?u+=" "+a:u+=" "+i(a);return u},n.deprecate=function(t,i){if(b(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(!0===e.noDeprecation)return t;var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),o=!0}return t.apply(this,arguments)}};var D,$={};n.debuglog=function(t){if(b(D)&&(D=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!$[t])if(new RegExp("\\b"+t+"\\b","i").test(D)){var r=e.pid;$[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else $[t]=function(){};return $[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=y,n.isNull=v,n.isNullOrUndefined=function(t){return null==t},n.isNumber=g,n.isString=m,n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=b,n.isRegExp=w,n.isObject=k,n.isDate=x,n.isError=_,n.isFunction=E,n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=t("./support/isBuffer");var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",A(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!k(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":20,_process:18,inherits:19}]},{},[3])(3)});